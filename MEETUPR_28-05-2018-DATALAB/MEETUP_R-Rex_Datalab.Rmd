---
title: "REX sur la mise en place d'un datalab R à RTE"
subtitle: "Meetup R Addicts x EDF"
author: "Christophe Dervieux"
date: "28 mai 2018"
output:
  xaringan::moon_reader:
    lib_dir: libs
    chakra: libs/remark-latest.min.js
    css: [default, metropolis]
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
      # beforeInit: "macros.js"
---

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
```

# A propos

* Utilisateurs de R depuis 6 ans maintenant
* RTE (Réseau de Transport d'Electricité)
* Depuis + d'1 an, en appui autour des sujets/projets R pour les chargés d'études et développeurs
  * Expertise
  * Formation
  * Déploiement - Mise en production
  * Solutions mutualisées pour les utilisateurs
  
.box[Mise en place d'un datalab]

???

Rattaché au niveau du SI dans les démarches d'open data interne.

Sujets:
- Développement de packages
- Mise en place datalab
- Conseil développement et expertise

---

# R en entreprise

.subtitle[c'est pas comme à la maison]

.pull-left[
**Poste de travail pas toujours adapté**
+ Pas son poste perso
+ Offre bureautique, non scientifique
+ Sécurité : Je ne peux pas vraiment faire ce que je veux (Proxy, non admin, ...)
]

.pull-right[
**Cadre technique de l'entreprise contraignant**
+ Respect d'un cadre technique pour le déploiement d'application en production
+ R non connu et référencé dans _les technologies validées_
+ Pas de solution de type cloud à disposition
]

.center[ 
**Comment améliorer le cadre de travail ?**  
**Contribuer à la transformation numérique de l'entreprise**
]

???

Pas de github, pas de travis, pas de codecov, etc... 

Pas open source donc pas gratuit

Je n'installe pas ce que je veux malheureusement 

Cadre limité

---

# Les grandes idées d'un Datalab ?

#### Un environnement mutualisé...
+ Collaboration entre équipes sur des projets
+ Accés aux données l'entreprise
+ Partage de la ressource de calcul

#### ...prêt à l'emploi...
+ Juste à se connecter
+ Pas d'installation, pas de configuration
+ Permettre à des débutants d'utiliser R comme un outil de manipulation de donnée

#### ...accompagné de service et solutions
+ Intégration à d'autres solutions
+ Packages Internes
+ Support / Expertise 

???

+ Offrir un environnemnt d'étude et de développement **mutualisé** et **prêt à l'emploi** 
+ Proposer des **services en interne** pour les datascientists, chargés d'études et développeurs.

Pleins de possibilités sur le web (shinyapps.io, Rpubs, Github, Github pages, Travis, ...). Et en interne ?

POurquoi ? Pour qui ?

Avantage: 
+ Déporté

Excel ++

**Mutualisé**: 
+ Favoriser la collaboration entre équipes sur des projets
+ Pouvoir accéder à des données centralisées (DataLake, DataWareHouse, ...)
+ Partager la ressource de calcul

**Prêt à l'emploi**:
+ Juste à se connecter, pas d'installation à faire, de version à gérer
+ Permettre à des débutants d'utiliser R comme un outil de manipulation de donnée

**Service en interne**:
+ Pleins de possibilités sur le web (shinyapps.io, Rpubs, Github, Github pages, Travis, ...). Et en interne ?

---

# Solution interne en mode serveurs

.center[

```{r, results='asis', echo = FALSE}
cat(readLines("draw-io_embded.txt"))
```

**En constante évolution**  
**Objectif: mettre R au coeur des usages pour la donnée**

]

???

+ 2 serveurs Rstudio Pro en cluster
+ 1 sereurs RStudio Connect
+ Un miroir interne du CRAN, avec possibilité de publier des packages internes
+ Accès à "l'usine de développement" (Gitlab, Jenkins, Nexus, SonarQube)
+ Accès aux données de l'entreprise

Lien vers présentation Benoit lors de sa conf

--- 
# S'adapter à un contexte technique d'entreprise

.center[
```{r, echo = FALSE}
words <- c("NAS", "LDAP", "ACLv3", "KERBEROS", "ACLv4", "NTLM", "HTTP_PROXY", "Redhat", "PAM", "CLI",
           "ODBC", "DSN", "FreeIPA", "ODBA", "EXADATA", "SSL", "kinit")
words <- sample(words, size = 30, replace = length(words) < 30)
freq <- sample(1:50, size = length(words), replace = TRUE)
wordcloud::wordcloud(words, freq, 
                     colors = RColorBrewer::brewer.pal(6,"Dark2"), random.color = TRUE, rot.per = 0.1)
```
]
---

# Quels points clés 

### Gestion des librairies
+ Mirroir CRAN Interne car environement offline
+ Un défi récurrent : Les dépendances systèmes
+ Librairies partagées sur les serveurs (`R_LIBS_SITE`)

### Mise à jour et reproductibilité
+ Version de R multiple
+ Une librairie partagé par version

---

# Customisation

### Simplifier l'utilisation

+ Au niveau de R : _Rprofile.site_ et _Renviron.site_
+ AU niveau des configurations RStudio

###  Améliorer l'expérience
+ Connexion centralisé aux données 
+ [Connection contract]()
+ [Addins RStudio]()
+ [Projet template]()

---

# Et à propos de R en production 

### Favoriser le déploiement

+ Environnement "standard" sur réseau interne
+ `packrat.lock` généré dans le datalab 
+ `packrat::restore()` pour le déploiement

---

# Ce qui a permis d'avancer

---

# Une communauté R-Admin

+ https://community.rstudio.com/c/r-admin

> This category is for discussions about R in production, at scale, and in complex environments.

+ Blog Rviews by RStudio : [R for Entreprise](https://rviews.rstudio.com/categories/r-for-the-enterprise/)

+ 
