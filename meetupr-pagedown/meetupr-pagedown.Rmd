---
title: "Pagedown pour de belles publications PDF avec HTML et CSS"
subtitle: "Meetup R Addicts"
author: "Christophe Dervieux"
knit: (function(inputFile, encoding) { rmarkdown::render(inputFile, output_file = "index.html", encoding = "UTF-8")})
date: "18 avril 2019"
output:
  xaringan::moon_reader:
    lib_dir: libs
    chakra: libs/remark-latest.min.js
    css: [default, custom.css]
    nature:
      highlightStyle: zenburn
      highlightSpans: true
      highlightLines: true
      countIncrementalSlides: false
      beforeInit: "macros.js"
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
```

# A propos
.subtitle[Courte introduction]
</br>
### Utilisateur de `r icon::fa_r_project()` depuis 7 ans
</br>    
### <img src="https://www.rte-france.com/sites/all/themes/rte/images/logo.png" height= "30" width="30"> RTE (Réseau de Transport d'Electricité)<sup>1</sup> 
</br>
### R admin, developer advocate. En appui des projets et des utilisateurs. 
</br>    
.pull-left[
.center[
### `r icon::fa_github()`
@cderv
]
]

.pull-right[
.center[
### `r icon::fa_twitter()`
@chrisderv
]
]

.footnote[
[1] cette présentation n'est pas dans un cadre officiel - juste un partage personnel. 
]

???

License:
CC BY-SA 4.0
https://creativecommons.org/licenses/by-sa/4.0/

---
# Rmarkdown pour produire des PDF... mais sans Latex
.subtitle[Une idée farfelue ?]
--
.center[
![:scale 100%](img/Bookdown-contest-pulpdown.png)
]

---
# Rmarkdown pour produire des PDF... mais sans Latex
.subtitle[C'est possible !]
.pull-left[
![:scale 260px](https://community.rstudio.com/uploads/default/optimized/2X/0/04ef1fae28be62be8e645652ebf5fb15ac7dce10_2_579x750.jpeg)

]

.pull-right[
![:scale 260px](https://community.rstudio.com/uploads/default/optimized/2X/3/38c159da843d4bde750a04b0472e66cc27b5d261_2_579x750.png)
]
</br>
* Projet Demo `r icon::fa_github()`: [**RLesur/pulpdown**](https://github.com/RLesur/pulpdown)
* Utilisation ici du logiciel [Prince XML](https://www.princexml.com/)

---

# Pagedown
.subtitle[Des html paginés avec Rmarkdown]


Suite au concours, une collaboration Yihui Xie et Romain Lesur 

</br>

Version 0.2 sur le CRAN : Experimental `r icon::fa_exclamation_circle()`  

</br>

Préférer une installation depuis `r icon::fa_github()`

```r
remotes::install_github('rstudio/pagedown')
```

Nécessite **Pandoc > 2** - RStudio 1.2 vient avec. (Sortie début Avril)

</br>  
Pour voir le résultat: Google Chrome ou Chromium recommandé.


---

# Utilisation
.subtitle[</br>]

De nombreux templates disponibles ! 
</br>
> File -> New File -> R Markdown -> From Template

.center[
![:scale 80%](img/template_rstudio.png)
]

---
layout:true
# Templates inclus
.subtitle[A réutiliser ou pour modèle]
---

.color1[**Paged HTML document** (`pagedown::html_paged`)]

https://pagedown.rbind.io/

![:scale 100%](https://user-images.githubusercontent.com/163582/47673682-58b11880-db83-11e8-87fd-b5e753af7288.png)

---

.color1[**Journal of Statistical Software article** (`pagedown::jss_paged`)]

![:scale 100%](https://user-images.githubusercontent.com/19177171/51005498-5b46cb80-153f-11e9-9026-4b50a9f3d3f1.png)

---
.color1[**Un CV** ! (`pagedown::html_resume`)]

![:scale 100%](https://user-images.githubusercontent.com/163582/46879762-7a34a500-ce0c-11e8-87e3-496f3577ff05.png)

---
.color1[**Une lettre** (`pagedown::html_letter`)]

![:scale 100%](https://user-images.githubusercontent.com/163582/47872372-61e8f200-dddc-11e8-839b-d8e8ef8f51eb.png)

---

.color1[Poster sur le theme de [Relaxed](https://github.com/RelaxedJS/ReLaXed) (`pagedown::poster_relaxed`)] .small[https://pagedown.rbind.io/poster-relaxed]

![:scale 60%](https://user-images.githubusercontent.com/163582/47672385-e12dba00-db7f-11e8-92de-af94d5bab12f.jpg)

.small[Full CSS ici - la mise en forme est faite totalement en CSS]
---

.color1[Livre "à la bookdown" (`pagedown::book_crc`)]
![:scale 90%](https://user-images.githubusercontent.com/163582/51346450-4b5d4900-1a63-11e9-8f22-dc632ab0b06b.png)

---
layout: false
# Des exemples dans la nature ? 
--
<iframe src="https://rlesur.gitlab.io/statcanrug/slides.pdf" width="900" height="500" style="border: none;"></iframe>
[Reproducible Corporate Publications with R](https://rlesur.gitlab.io/statcanrug/slides.pdf) par Romain Lesur
---
# Rendu possible par Paged.js
.subtitle[Une librairie open-source pour</br>paginer des contenus dans un navigateur]

[Paged.js](https://www.pagedmedia.org/paged-js/), c'est un .color1[**Polyfill**]
> Un polyfill, c’est simple. C’est un ensemble de fonctions permettant de simuler, sur un navigateur web ancien, des fonctionnalités qui ne sont pas nativement disponible. <sup>1</sup>

Ici, _Paged.js_ vient rendre disponibles les spécifications W3C sur [Paged Media](https://www.w3.org/TR/css-page-3/) et [Generated Content for Paged Media](https://www.w3.org/TR/css-gcpm-3/) sur les navigateurs récents.
Il vient donc compléter Chrome qui [supporte](https://caniuse.com/#feat=css-paged-media) uniquement une toute petite partie.

</br>
.box[
.color1[`r icon::fa_exclamation_circle()` Une librairie JS en plein développement]
]

.footnote[(1) https://blog.eleven-labs.com/fr/tutoriel-polyfill/]
---
layout: true
# Les principes
.subtitle[CSS Paged Media & paged.js]
---
.left-column[
### CSS for Paged MediaStandard 
]
.right-column[
CSS for Paged Media standard est un bout de la norme CSS W3C: 
* CSS Paged Media Module Level 3
* CSS Generated Content for Paged Media Module
* CSS Page Floats
*CSS Fragmentation Module Level 3

Utilisé dans la publication par les éditeurs ([Streamlining CSS Print Design with Sass](https://medium.com/@sandersk/streamlining-css-print-design-with-sass-debaa2a204c3))

]
---
.left-column[
### CSS for Paged MediaStandard 
### The Page Model
]

.right-column[
.center[
![:scale 50%](https://www.w3.org/TR/css-page-3/images/PageBox.png)
]
```css
@page {
  size: A5;
}
@page {
  margin: 1in 2in .5in 2in;
}
```
]

---
.left-column[
### CSS for Paged MediaStandard 
### The Page Model
### Margin Box
]

.right-column[
* Découpage d'une page et des marges en boites identifiables
.center[
![:scale 70%](https://www.pagedmedia.org/wp-content/uploads/2018/11/9d1dd9cee0c92ee1d7865d7a0ba428d7.svg)
]
* Dans chaque boite, des règles CSS classiques
]
---
.left-column[
### CSS for Paged MediaStandard 
### The Page Model
### Margin Box
]
.right-column[

```css
@page {
  size: a4;
  margin: 15mm;
  @top-center {
    content: "Mon Document Paginé";
  }
  @bottom-right-corner {
    content: "p. " counter(page);    
  }
}

@page :right {
  @bottom-right-corner {
    content: counter(page)"/"counter(pages);    
  }
}

@page :left {
  @bottom-left-corner {
    content: counter(page)"/"counter(pages);    
  }
}

```
]
---
.left-column[
### Le standard CSS for Paged Media 
### Le modèle Page
### Les "Margin Box"
### Saut de pages 
]

.right-column[
* Saut de page avant tous les titres 1

```css
h1 {
  page-break-before: always;
}
```

* Eviter les sauts dans un tableau

```css
table {
  page-break-inside: avoid;
}
```
]
---
layout: false
# Comment modifier les templates ? 
